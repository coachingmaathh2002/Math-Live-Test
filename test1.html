<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLST Mathematics Quiz</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        secondary: {
                            50: '#f5f3ff',
                            100: '#ede9fe',
                            200: '#ddd6fe',
                            300: '#c4b5fd',
                            400: '#a78bfa',
                            500: '#8b5cf6',
                            600: '#7c3aed',
                            700: '#6d28d9',
                            800: '#5b21b6',
                            900: '#4c1d95',
                        },
                        success: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                        },
                        warning: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        },
                        danger: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                        }
                    }
                }
            }
        }
    </script>
    <!-- MathJax Configuration (before MathJax script) -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <!-- MathJax CDN for LaTeX rendering -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: "Inter", sans-serif;
            background-color: #f8fafc;
        }
        
        .quiz-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }
        
        .question-card {
            background-color: white;
            border: 1px solid #e2e8f0;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.03);
            transition: all 0.2s ease;
        }
        
        .question-card:hover {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }
        
        .option-label {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            margin-bottom: 0.75rem;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .option-label:hover {
            background-color: #f8fafc;
            border-color: #cbd5e1;
        }
        
        .option-label.selected {
            background-color: #e0f2fe;
            border-color: #7dd3fc;
        }
        
        .option-label.correct {
            background-color: #dcfce7;
            border-color: #86efac;
        }
        
        .option-label.incorrect {
            background-color: #fee2e2;
            border-color: #fca5a5;
        }
        
        .custom-radio {
            width: 20px;
            height: 20px;
            border: 2px solid #cbd5e1;
            border-radius: 50%;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .custom-radio-inner {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: transparent;
            transition: all 0.2s ease;
            transform: scale(0);
        }
        
        .option-label.selected .custom-radio {
            border-color: #0ea5e9;
        }
        
        .option-label.selected .custom-radio-inner {
            background-color: #0ea5e9;
            transform: scale(1);
        }
        
        .option-label.correct .custom-radio {
            border-color: #22c55e;
        }
        
        .option-label.correct .custom-radio-inner {
            background-color: #22c55e;
            transform: scale(1);
        }
        
        .option-label.incorrect .custom-radio {
            border-color: #ef4444;
        }
        
        .option-label.incorrect .custom-radio-inner {
            background-color: #ef4444;
            transform: scale(1);
        }
        
        .rationale-box {
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            display: none;
        }
        
        .rationale-correct {
            background-color: #f0fdf4;
            border-left: 4px solid #22c55e;
            color: #166534;
        }
        
        .rationale-incorrect {
            background-color: #fef2f2;
            border-left: 4px solid #ef4444;
            color: #991b1b;
        }
        
        .rationale-missing {
            background-color: #fffbeb;
            border-left: 4px solid #f59e0b;
            color: #92400e;
        }
        
        .submit-quiz-btn {
            background-color: #0ea5e9;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px rgba(14, 165, 233, 0.2);
            display: block;
            margin: 2rem auto 0;
            width: fit-content;
        }
        
        .submit-quiz-btn:hover {
            background-color: #0284c7;
            transform: translateY(-1px);
            box-shadow: 0 6px 8px rgba(14, 165, 233, 0.3);
        }
        
        .submit-quiz-btn:active {
            transform: translateY(0);
        }
        
        .submit-quiz-btn:disabled {
            background-color: #cbd5e1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .timer-display {
            font-size: 1.25rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 1.5rem;
            padding: 0.5rem;
            border-radius: 8px;
            background-color: #f8fafc;
        }
        
        .timer-normal {
            color: #0ea5e9;
        }
        
        .timer-warning {
            color: #f59e0b;
            animation: pulse 1s infinite;
        }
        
        .timer-critical {
            color: #ef4444;
            animation: pulse 0.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .progress-bar {
            height: 6px;
            background-color: #e2e8f0;
            border-radius: 3px;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #0ea5e9;
            transition: width 0.3s ease;
        }
        
        .hint-text {
            background-color: #f8fafc;
            padding: 0.75rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #64748b;
            border-left: 3px solid #cbd5e1;
        }
        
        .score-display {
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 2rem;
            padding: 1rem;
            border-radius: 12px;
            background-color: #f8fafc;
        }
        
        .score-good {
            color: #22c55e;
            border: 2px solid #86efac;
        }
        
        .score-average {
            color: #f59e0b;
            border: 2px solid #fde68a;
        }
        
        .score-poor {
            color: #ef4444;
            border: 2px solid #fca5a5;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="quiz-container">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-primary-800 mb-2">SLST Mathematics Quiz</h1>
            <p class="text-gray-600">Test your knowledge of Class 9-10 Mathematics concepts</p>
        </div>

        <div id="timer-display" class="timer-display timer-normal"></div>
        <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
        </div>

        <div id="quiz-questions">
            <!-- Questions will be loaded here by JavaScript -->
        </div>

        <button id="submit-quiz-btn" class="submit-quiz-btn">Submit Quiz</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const quizData = {
                "questions": [
                    {
                        "question": "If $x = \\cos \\theta + i \\sin \\theta$, what is the value of $x^n + \\frac{1}{x^n}$?",
                        "answerOptions": [
                            {
                                "text": "$2 \\cos n\\theta$",
                                "rationale": "Using De Moivre's theorem, $x^n = \\cos n\\theta + i \\sin n\\theta$ and $\\frac{1}{x^n} = x^{-n} = \\cos n\\theta - i \\sin n\\theta$. Adding these two expressions yields the result.",
                                "isCorrect": true
                            },
                            {
                                "text": "$2i \\sin n\\theta$",
                                "rationale": "This would be the result of subtracting $1/x^n$ from $x^n$, not adding them.",
                                "isCorrect": false
                            },
                            {
                                "text": "$\\cos n\\theta$",
                                "rationale": "This answer incorrectly omits the factor of 2 that results from combining the real parts of the two complex numbers.",
                                "isCorrect": false
                            },
                            {
                                "text": "$0$",
                                "rationale": "This would only be true if the two expressions were additive inverses, which they are not.",
                                "isCorrect": false
                            }
                        ],
                        "hint": "Apply De Moivre's theorem to both $x^n$ and $x^{-n}$, and then add the resulting expressions."
                    },
                    {
                        "question": "What are the eigenvalues of the matrix $A = \\begin{pmatrix} 1 & -3 & 3 \\\\ 3 & -5 & 3 \\\\ 6 & -6 & 4 \\end{pmatrix}$?",
                        "answerOptions": [
                            {
                                "text": "2, 2, -1",
                                "rationale": "This set of eigenvalues is incorrect. The characteristic equation must be solved accurately to find the correct roots.",
                                "isCorrect": false
                            },
                            {
                                "text": "4, -2, -2",
                                "rationale": "This is the correct set of eigenvalues, obtained by finding the roots of the characteristic equation, $\\det(A - \\lambda I) = 0$.",
                                "isCorrect": true
                            },
                            {
                                "text": "1, -5, 4",
                                "rationale": "These are the diagonal elements of the matrix, which are not necessarily the eigenvalues unless the matrix is triangular.",
                                "isCorrect": false
                            },
                            {
                                "text": "4, 2, 1",
                                "rationale": "This set contains incorrect values, likely resulting from an error in calculating the determinant for the characteristic equation.",
                                "isCorrect": false
                            }
                        ],
                        "hint": "Find the characteristic equation by solving $\\det(A - \\lambda I) = 0$ for $\\lambda$."
                    },
                    {
                        "question": "Which of the following subgroups is a normal subgroup of the symmetric group $S_3$?",
                        "answerOptions": [
                            {
                                "text": "The alternating group $A_3$",
                                "rationale": "The alternating group $A_n$ is always a normal subgroup of the symmetric group $S_n$. For $n=3$, $A_3$ has an index of 2, which guarantees it is a normal subgroup.",
                                "isCorrect": true
                            },
                            {
                                "text": "The subgroup generated by a single transposition, e.g., $\\{(1), (1 2)\\}$",
                                "rationale": "A subgroup generated by a single transposition is not normal because its left and right cosets are not equal for all elements in $S_3$.",
                                "isCorrect": false
                            },
                            {
                                "text": "The trivial subgroup containing only the identity element",
                                "rationale": "While the trivial subgroup is always normal, the question asks for a non-trivial normal subgroup, and $A_3$ is a more specific and significant example for $S_3$.",
                                "isCorrect": false
                            },
                            {
                                "text": "$S_3$ itself",
                                "rationale": "While a group is always a normal subgroup of itself, this is considered a trivial normal subgroup. The alternating group is the only non-trivial proper normal subgroup of $S_3$.",
                                "isCorrect": false
                            }
                        ],
                        "hint": "Recall that a subgroup H of G is normal if its index [G:H] is 2. The alternating group consists of all even permutations."
                    },
                    {
                        "question": "What is the angle between the pair of straight lines represented by the equation $x^2 - y^2 = 0$?",
                        "answerOptions": [
                            {
                                "text": "$45^\\circ$",
                                "rationale": "The formula for the angle between lines $ax^2 + 2hxy + by^2 = 0$ would yield $45^\\circ$ if the coefficients were different.",
                                "isCorrect": false
                            },
                            {
                                "text": "$60^\\circ$",
                                "rationale": "This angle does not correspond to the given equation, which represents a pair of perpendicular lines.",
                                "isCorrect": false
                            },
                            {
                                "text": "$90^\\circ$",
                                "rationale": "The equation can be factored into $(x-y)(x+y)=0$, which represents the lines $y=x$ and $y=-x$. The condition for perpendicularity, $a+b=0$, is met since $1+(-1)=0$.",
                                "isCorrect": true
                            },
                            {
                                "text": "$180^\\circ$",
                                "rationale": "An angle of 180 degrees would imply the lines are coincident, which is not the case here.",
                                "isCorrect": false
                            }
                        ],
                        "hint": "Consider the condition for perpendicularity for a pair of straight lines given by a homogeneous second-degree equation, which is that the sum of the coefficients of $x^2$ and $y^2$ is zero."
                            },
                    {
                        "question": "Find the equation of the plane that passes through the point (1, -2, 4) and is perpendicular to the line joining the points (3, 2, 1) and (5, 4, 3).",
                        "answerOptions": [
                            {
                                "text": "$x + y + z = 3$",
                                "rationale": "The direction ratios of the normal to the plane are $(5-3, 4-2, 3-1)=(2,2,2)$, or simplified to $(1,1,1)$. Substituting the point (1,-2,4) into the plane equation $1(x-1)+1(y+2)+1(z-4)=0$ gives the correct result.",
                                "isCorrect": true
                            },
                            {
                                "text": "$2x + 2y + 2z = 5$",
                                "rationale": "This equation has the correct direction ratios for the normal, but it does not pass through the given point (1, -2, 4).",
                                "isCorrect": false
                            },
                            {
                                "text": "$x + y - z = -5$",
                                "rationale": "This option contains a sign error in the direction ratios of the normal vector.",
                                "isCorrect": false
                            },
                            {
                                "text": "$x - y + z = 7$",
                                "rationale": "This equation does not use the correct direction ratios for the normal vector derived from the two points.",
                                "isCorrect": false
                            }
                        ],
                        "hint": "The direction ratios of the line will be the direction ratios of the normal vector to the plane. Use the point-normal form of the plane equation."
                    },
                    {
                        "question": "For which value of 'k' does Rolle's theorem apply to the function $f(x) = x^2 + 3x + k$ on the interval [-2, -1]?",
                        "answerOptions": [
                            {
                                "text": "-2",
                                "rationale": "This value does not satisfy the condition $f(-2) = f(-1)$ for Rolle's theorem.",
                                "isCorrect": false
                            },
                            {
                                "text": "0",
                                "rationale": "This is another value for which the condition $f(a) = f(b)$ is not met.",
                                "isCorrect": false
                            },
                            {
                                "text": "2",
                                "rationale": "This value results from a calculation error when setting $f(-2)$ equal to $f(-1)$.",
                                "isCorrect": false
                            },
                            {
                                "text": "No specific value of k is needed",
                                "rationale": "For Rolle's Theorem to apply, we need $f(-2) = f(-1)$. Evaluating this gives $4-6+k = 1-3+k$, which simplifies to $-2 = -2$. This identity is true for any value of k.",
                                "isCorrect": true
                            }
                        ],
                        "hint": "Rolle's theorem requires three conditions: continuity on the closed interval, differentiability on the open interval, and equality of the function values at the endpoints. Check the third condition, $f(a) = f(b)$."
                    },
                    {
                        "question": "What is the value of the integral $\\int_{0}^{\\pi/2} \\sin^4 x \\, dx$?",
                        "answerOptions": [
                            {
                                "text": "$\\frac{3\\pi}{16}$",
                                "rationale": "Using the reduction formula for $\\int \\sin^n x \\, dx$, which is based on integration by parts, leads to this correct result.",
                                "isCorrect": true
                            },
                            {
                                "text": "$\\frac{3\\pi}{8}$",
                                "rationale": "This answer suggests an error in applying the reduction formula, possibly by a factor of 2.",
                                "isCorrect": false
                            },
                            {
                                "text": "$\\frac{\\pi}{16}$",
                                "rationale": "This result might come from miscalculating the coefficients in the reduction formula.",
                                "isCorrect": false
                            },
                            {
                                "text": "$\\frac{3}{16}$",
                                "rationale": "This answer is missing the factor of $\\pi$ that arises from evaluating the integral at its limits.",
                                "isCorrect": false
                            }
                        ],
                        "hint": "Apply the reduction formula for $\\int \\sin^n x \\, dx$, or use Walli's formula for definite integrals of this type."
                    },
                    {
                        "question": "Three vectors $\\vec{a} = \\hat{i} + \\hat{j} + \\hat{k}$, $\\vec{b} = 2\\hat{i} - 4\\hat{k}$, and $\\vec{c} = \\hat{i} + \\lambda\\hat{j} + 3\\hat{k}$ are coplanar. What is the value of $\\lambda$?",
                        "answerOptions": [
                            {
                                "text": "5/3",
                                "rationale": "This value would result from a sign error in the determinant calculation.",
                                "isCorrect": false
                            },
                            {
                                "text": "7/3",
                                "rationale": "This is another possible result if an arithmetic mistake is made while solving for lambda.",
                                "isCorrect": false
                            },
                            {
                                "text": "5",
                                "rationale": "This answer comes from an incorrect expansion of the determinant used to check for coplanarity.",
                                "isCorrect": false
                            },
                            {
                                "text": "7",
                                "rationale": "For the vectors to be coplanar, their scalar triple product must be zero. Setting the determinant of the matrix formed by the vectors to zero and solving for $\\lambda$ gives this result.",
                                "isCorrect": true
                            }
                        ],
                        "hint": "Three vectors are coplanar if and only if their scalar triple product, $[\\vec{a} \\vec{b} \\vec{c}]$, is equal to zero."
                    },
                    {
                        "question": "A particle is projected with a velocity of 20 m/s at an angle of $60^\\circ$ with the horizontal. What is its velocity at the highest point of its trajectory?",
                        "answerOptions": [
                            {
                                "text": "0 m/s",
                                "rationale": "The vertical component of velocity is zero at the highest point, but the horizontal component remains constant.",
                                "isCorrect": false
                            },
                            {
                                "text": "10 m/s",
                                "rationale": "At the highest point, only the horizontal component of the initial velocity, $v \\cos \\theta$, remains. Here, it is $20 \\cos 60^\\circ$.",
                                "isCorrect": true
                            },
                            {
                                "text": "$10\\sqrt{3}$ m/s",
                                "rationale": "This is the initial vertical component of the velocity, $v \\sin \\theta$, which becomes zero at the highest point.",
                                "isCorrect": false
                            },
                            {
                                "text": "20 m/s",
                                "rationale": "The velocity is only equal to the initial velocity at the moment of projection and, in magnitude, at the point of landing.",
                                "isCorrect": false
                            }
                        ],
                        "hint": "In projectile motion, the horizontal component of velocity is constant throughout the flight, while the vertical component is affected by gravity."
                    },
                    {
                        "question": "What is the standard deviation of the data set: 2, 4, 5, 6, 8?",
                        "answerOptions": [
                            {
                                "text": "5",
                                "rationale": "This is the mean of the data set, not the standard deviation.",
                                "isCorrect": false
                            },
                            {
                                "text": "4",
                                "rationale": "This is the variance of the data set, which is the square of the standard deviation.",
                                "isCorrect": false
                            },
                            {
                                "text": "2",
                                "rationale": "The variance is calculated as the average of the squared differences from the mean, and the standard deviation is its square root.",
                                "isCorrect": true
                            },
                            {
                                "text": "2.5",
                                "rationale": "This result likely stems from an arithmetic error during the calculation of the variance.",
                                "isCorrect": false
                            }
                        ],
                        "hint": "First, calculate the mean of the data. Then, find the variance by averaging the squared differences from the mean. The standard deviation is the square root of the variance."
                    }
                ]
            };

            const quizQuestionsDiv = document.getElementById('quiz-questions');
            const timerDisplay = document.getElementById('timer-display');
            const submitQuizBtn = document.getElementById('submit-quiz-btn');
            const progressFill = document.getElementById('progress-fill');

            let timeLeft = 300; // 5 minutes in seconds
            let timerInterval;

            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            }

            function updateTimer() {
                timerDisplay.textContent = `Time Left: ${formatTime(timeLeft)}`;
                
                // Update progress bar
                const progressPercentage = (timeLeft / 300) * 100;
                progressFill.style.width = `${progressPercentage}%`;
                
                // Update timer colors and effects
                timerDisplay.className = 'timer-display timer-normal';
                if (timeLeft <= 60) {
                    timerDisplay.className = 'timer-display timer-warning';
                }
                if (timeLeft <= 10) {
                    timerDisplay.className = 'timer-display timer-critical';
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz(true); // Auto-submit
                } else {
                    timeLeft--;
                }
            }

            function submitQuiz(autoSubmitted = false) {
                clearInterval(timerInterval);
                submitQuizBtn.disabled = true;
                submitQuizBtn.textContent = autoSubmitted ? 'Time Up! Quiz Submitted' : 'Quiz Submitted';

                let correctAnswersCount = 0;
                quizData.questions.forEach((q, index) => {
                    const questionCard = quizQuestionsDiv.children[index];
                    const optionsContainer = questionCard.querySelector('.options-container');
                    const radioInputs = optionsContainer.querySelectorAll('input[type="radio"]');
                    const rationaleBox = questionCard.querySelector('.rationale-box');
                    const optionLabels = questionCard.querySelectorAll('.option-label');

                    rationaleBox.style.display = 'block'; // Show rationale

                    let selectedOptionIndex = -1;
                    radioInputs.forEach((input, optIndex) => {
                        input.disabled = true; // Disable all options after submit
                        if (input.checked) {
                            selectedOptionIndex = optIndex;
                            optionLabels[optIndex].classList.add('selected');
                        }
                    });

                    // Mark correct and incorrect answers
                    q.answerOptions.forEach((option, optIndex) => {
                        if (option.isCorrect) {
                            optionLabels[optIndex].classList.add('correct');
                        } else if (selectedOptionIndex === optIndex) {
                            optionLabels[optIndex].classList.add('incorrect');
                        }
                    });

                    let rationaleContent = '';
                    if (selectedOptionIndex !== -1) {
                        const selectedOption = q.answerOptions[selectedOptionIndex];
                        if (selectedOption.isCorrect) {
                            rationaleContent = `<strong class="text-success-700">Correct!</strong> ${selectedOption.rationale}`;
                            rationaleBox.className = 'rationale-box rationale-correct';
                            correctAnswersCount++;
                        } else {
                            const correctOption = q.answerOptions.find(opt => opt.isCorrect);
                            rationaleContent = `<strong class="text-danger-700">Incorrect.</strong> ${selectedOption.rationale} <br><br><strong class="text-success-700">Correct answer:</strong> ${correctOption.text}. ${correctOption.rationale}`;
                            rationaleBox.className = 'rationale-box rationale-incorrect';
                        }
                    } else {
                        const correctOption = q.answerOptions.find(opt => opt.isCorrect);
                        rationaleContent = `<strong class="text-warning-700">You did not select an answer.</strong> <br><br><strong class="text-success-700">Correct answer:</strong> ${correctOption.text}. ${correctOption.rationale}`;
                        rationaleBox.className = 'rationale-box rationale-missing';
                    }
                    rationaleBox.innerHTML = rationaleContent;
                    
                    // Ensure MathJax typesets the rationale content after it's set
                    if (typeof MathJax !== 'undefined') {
                        MathJax.typesetPromise([rationaleBox]);
                    }
                });

                const scorePercentage = Math.round((correctAnswersCount / quizData.questions.length) * 100);
                const scoreDisplay = document.createElement('div');
                scoreDisplay.className = 'score-display';
                
                if (scorePercentage >= 70) {
                    scoreDisplay.classList.add('score-good');
                } else if (scorePercentage >= 40) {
                    scoreDisplay.classList.add('score-average');
                } else {
                    scoreDisplay.classList.add('score-poor');
                }
                
                scoreDisplay.innerHTML = `
                    <div class="text-2xl font-bold">Your Score: ${correctAnswersCount}/${quizData.questions.length}</div>
                    <div class="text-lg">${scorePercentage}% Correct</div>
                `;
                
                quizQuestionsDiv.prepend(scoreDisplay); // Add score at the top
            }

            // Populate quiz questions
            quizData.questions.forEach((q, index) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';

                const questionText = document.createElement('p');
                questionText.className = 'text-lg font-semibold text-gray-800 mb-4';
                questionText.innerHTML = `<span class="text-primary-600 font-bold">Question ${index + 1}:</span> ${q.question}`;
                questionCard.appendChild(questionText);

                const optionsContainer = document.createElement('div');
                optionsContainer.className = 'options-container space-y-3';

                q.answerOptions.forEach((option, optionIndex) => {
                    const optionDiv = document.createElement('div');
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.name = `question-${index}`;
                    radioInput.id = `q${index}-option${optionIndex}`;
                    radioInput.className = 'hidden'; // Hide default radio button

                    const label = document.createElement('label');
                    label.htmlFor = `q${index}-option${optionIndex}`;
                    label.className = 'option-label';

                    const customRadio = document.createElement('div');
                    customRadio.className = 'custom-radio';
                    customRadio.innerHTML = '<div class="custom-radio-inner"></div>';

                    const optionText = document.createElement('span');
                    optionText.className = 'text-gray-800';
                    optionText.innerHTML = option.text;

                    label.appendChild(radioInput);
                    label.appendChild(customRadio);
                    label.appendChild(optionText);
                    optionsContainer.appendChild(label);

                    // Add event listener to update styling when option is selected
                    radioInput.addEventListener('change', function() {
                        // Remove selected class from all options in this question
                        const allOptions = optionsContainer.querySelectorAll('.option-label');
                        allOptions.forEach(opt => {
                            opt.classList.remove('selected');
                        });

                        // Add selected class to the clicked option
                        if (this.checked) {
                            label.classList.add('selected');
                        }
                    });
                });
                questionCard.appendChild(optionsContainer);

                const hintText = document.createElement('div');
                hintText.className = 'hint-text';
                hintText.innerHTML = `<strong>Hint:</strong> ${q.hint}`;
                questionCard.appendChild(hintText);

                // Rationale box for each question (initially hidden)
                const rationaleBox = document.createElement('div');
                rationaleBox.className = 'rationale-box';
                questionCard.appendChild(rationaleBox);

                quizQuestionsDiv.appendChild(questionCard);
            });

            // Start timer
            timerInterval = setInterval(updateTimer, 1000);
            updateTimer(); // Initial call to display time immediately

            // Submit button event listener
            submitQuizBtn.addEventListener('click', () => submitQuiz(false));

            // Initial MathJax typesetting for all questions after they are added
            if (typeof MathJax !== 'undefined') {
                MathJax.typesetPromise();
            } else {
                console.error("MathJax was not defined after quiz population.");
            }
        });
    </script>
</body>
</html>
